# Requirements Document

## はじめに

Mitos（ミトス）は、AIエージェントによる大規模開発時代に最適化されたモダンなターミナルマルチプレクサです。既存のターミナルマルチプレクサ（tmux、screen、Zellij等）の優れた機能を取り入れつつ、Git Worktreeとのシームレスな統合により、複数のブランチやプロジェクトを効率的に管理できる新しい開発体験を提供します。

本MVPでは、以下の核心機能に焦点を当てます：
- **基本的なターミナルマルチプレクサ機能**: ペイン分割と管理
- **プロセスベースのペインタイトル**: Zellij風の自動タイトル表示
- **Git Worktree統合**: ブランチ切り替えとペイン管理の統一
- **クロスプラットフォーム対応**: Windows Native、Linux、macOSで動作

## Requirements

### Requirement 1: コアターミナルマルチプレクサ機能
**ユーザーストーリー:** 開発者として、複数のターミナルセッションを効率的に管理し、ペイン間を素早く移動したい

#### 受け入れ基準

1. WHEN ユーザーが新しいペインを作成する THEN システムは現在のペインを分割して新しいペインを表示する SHALL
2. WHEN ユーザーが水平分割を要求する THEN システムは現在のペインを上下に分割する SHALL  
3. WHEN ユーザーが垂直分割を要求する THEN システムは現在のペインを左右に分割する SHALL
4. WHEN ユーザーがペイン間を移動する THEN システムはフォーカスを指定されたペインに切り替える SHALL
5. IF ペインのサイズが最小サイズ（5行×10列）未満になる THEN システムはペインの作成を拒否する SHALL
6. WHILE ターミナルウィンドウがリサイズされる THE システムは全ペインのレイアウトを比例的に調整する SHALL
7. WHERE ペインが閉じられた場合 THE システムは隣接するペインを自動的に拡張する SHALL

### Requirement 2: ペインタイトル管理
**ユーザーストーリー:** 開発者として、各ペインが何を実行しているか一目で把握できるよう、実行中のプロセス名を自動的にタイトルとして表示してほしい

#### 受け入れ基準

1. WHEN プロセスが実行される THEN システムは実行中のプロセス名をペインタイトルとして自動的に表示する SHALL
2. IF フォアグラウンドプロセスが変更される THEN システムは新しいプロセス名でタイトルを即座に更新する SHALL
3. WHEN シェルがアイドル状態 THEN システムは現在のディレクトリ名またはシェル名をタイトルとして表示する SHALL
4. IF ユーザーがカスタムタイトルを設定する THEN システムはプロセス名より優先してカスタムタイトルを表示する SHALL
5. WHERE タイトルが画面幅を超える場合 THE システムは省略記号（...）でタイトルを切り詰める SHALL
6. WHEN 複数のプロセスがパイプラインで実行される THEN システムは最初のプロセス名を表示する SHALL
7. IF AIエージェントがペインで作業中 THEN システムはプロセス名と共にエージェント識別子を表示する SHALL

### Requirement 3: Git Worktree統合
**ユーザーストーリー:** 開発者として、フッター領域を活用したGit Worktree管理UIにより、ペイン作業を中断することなくブランチ間の切り替えを効率化したい

#### 受け入れ基準

1. WHEN システムが起動する THEN フッター領域に現在のWorktreeステータスを1行で表示する SHALL
2. WHEN ユーザーがGit Worktreeモードを起動する（例：Ctrl+G） THEN システムはフッター領域を展開してWorktree管理UIを表示する SHALL
3. WHILE フッター領域が展開されている THE システムはペイン領域を自動的に縮小して全体の表示を調整する SHALL
4. WHEN フッター領域でWorktreeが選択される THEN システムは新しいペインを作成し該当Worktreeディレクトリで開く SHALL
5. IF 選択されたWorktreeが既にペインで開かれている THEN システムはそのペインにフォーカスを移動する SHALL
6. WHEN ユーザーがフッター領域で新しいWorktreeを作成する THEN システムはgitコマンドを実行し完了後に新しいペインを開く SHALL
7. WHERE 複数のWorktreeが存在する場合 THE システムは各Worktreeの状態（ペイン数、パスなど）をフッター領域に表示する SHALL
8. WHEN ユーザーがESCキーを押す OR Git操作が完了する THEN システムはフッター領域を最小化しペイン領域を元のサイズに戻す SHALL
9. IF Worktreeに関連するペインが存在する THEN システムはペインタイトルにブランチ名を含める SHALL

### Requirement 4: クロスプラットフォーム対応
**ユーザーストーリー:** 開発者として、Windows、Linux、macOSの全てで同じ操作体験を得たい

#### 受け入れ基準

1. WHEN システムがWindows上で起動する THEN Windows Terminal APIまたはConPTYを使用してターミナルを制御する SHALL
2. WHEN システムがLinux/macOS上で起動する THEN PTYを使用してターミナルを制御する SHALL
3. IF プラットフォーム固有の機能が利用可能 THEN システムはその機能を活用してパフォーマンスを最適化する SHALL
4. WHERE キーバインディングが定義されている場合 THE システムは各プラットフォームの慣習に従ったデフォルト設定を提供する SHALL
5. WHEN ユーザーが設定をエクスポートする THEN システムはプラットフォーム間で互換性のある設定ファイルを生成する SHALL

### Requirement 5: 基本的なパフォーマンス要件
**ユーザーストーリー:** 開発者として、通常の開発作業で快適に使用できるレスポンシブなターミナル体験を求める

#### 受け入れ基準

1. WHEN テキストが出力される THEN システムは30FPS以上のレンダリングを維持する SHALL
2. WHEN ユーザーがキー入力する THEN システムは50ms以内に画面に反映する SHALL
3. WHERE 複数のペインが同時に更新される場合 THE システムは各ペインを独立してレンダリングする SHALL
4. IF システムリソースが逼迫する THEN システムは描画を適応的に調整してレスポンシブ性を維持する SHALL